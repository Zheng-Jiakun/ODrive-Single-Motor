ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"motor_driver.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.read_hall,"ax",%progbits
  18              		.align	1
  19              		.global	read_hall
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	read_hall:
  26              	.LFB130:
  27              		.file 1 "Src/User/motor_driver.c"
   1:Src/User/motor_driver.c **** #include "motor_driver.h"
   2:Src/User/motor_driver.c **** 
   3:Src/User/motor_driver.c **** motor_t motor;
   4:Src/User/motor_driver.c **** 
   5:Src/User/motor_driver.c **** uint16_t drv8301_spi_rx_dat, drv8301_spi_tx_dat;
   6:Src/User/motor_driver.c **** uint16_t adc_result_raw, adc_result;
   7:Src/User/motor_driver.c **** float current_dc_offset;
   8:Src/User/motor_driver.c **** 
   9:Src/User/motor_driver.c **** pid_t motor_pid_current, motor_pid_speed, motor_pid_position;
  10:Src/User/motor_driver.c **** 
  11:Src/User/motor_driver.c **** const uint8_t hall_state_sequence[] = {0, 6, 4, 5, 2, 1, 3, 0}; //map hall states as 1~6 or 6~1
  12:Src/User/motor_driver.c **** 
  13:Src/User/motor_driver.c **** // {0, 6, 4, 5, 2, 1, 3, 0}{0, 1, 3, 2, 5, 6, 4, 0}
  14:Src/User/motor_driver.c **** 
  15:Src/User/motor_driver.c **** uint8_t read_hall()
  16:Src/User/motor_driver.c **** {
  28              		.loc 1 16 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32 0000 10B5     		push	{r4, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 4, -8
  36              		.cfi_offset 14, -4
  37              	.LVL0:
  17:Src/User/motor_driver.c ****     uint8_t hall = 0b000;
  18:Src/User/motor_driver.c **** 
  19:Src/User/motor_driver.c ****     if (HAL_GPIO_ReadPin(M1_HALL_A_GPIO_Port, M1_HALL_A_Pin) == GPIO_PIN_SET)
  38              		.loc 1 19 0
  39 0002 1021     		movs	r1, #16
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 2


  40 0004 0E48     		ldr	r0, .L9
  41 0006 FFF7FEFF 		bl	HAL_GPIO_ReadPin
  42              	.LVL1:
  43 000a 0128     		cmp	r0, #1
  44 000c 0FD0     		beq	.L5
  17:Src/User/motor_driver.c ****     uint8_t hall = 0b000;
  45              		.loc 1 17 0
  46 000e 0024     		movs	r4, #0
  47              	.L2:
  48              	.LVL2:
  20:Src/User/motor_driver.c ****         hall |= 0b001;
  21:Src/User/motor_driver.c ****     if (HAL_GPIO_ReadPin(M1_HALL_B_GPIO_Port, M1_HALL_B_Pin) == GPIO_PIN_SET)
  49              		.loc 1 21 0
  50 0010 2021     		movs	r1, #32
  51 0012 0B48     		ldr	r0, .L9
  52 0014 FFF7FEFF 		bl	HAL_GPIO_ReadPin
  53              	.LVL3:
  54 0018 0128     		cmp	r0, #1
  55 001a 0AD0     		beq	.L7
  56              	.L3:
  22:Src/User/motor_driver.c ****         hall |= 0b100;
  23:Src/User/motor_driver.c ****     if (HAL_GPIO_ReadPin(M1_HALL_C_GPIO_Port, M1_HALL_C_Pin) == GPIO_PIN_SET)
  57              		.loc 1 23 0
  58 001c 4FF40071 		mov	r1, #512
  59 0020 0848     		ldr	r0, .L9+4
  60 0022 FFF7FEFF 		bl	HAL_GPIO_ReadPin
  61              	.LVL4:
  62 0026 0128     		cmp	r0, #1
  63 0028 06D0     		beq	.L8
  64              	.L4:
  24:Src/User/motor_driver.c ****         hall |= 0b010;
  25:Src/User/motor_driver.c **** 
  26:Src/User/motor_driver.c ****     return hall;
  27:Src/User/motor_driver.c **** }
  65              		.loc 1 27 0
  66 002a 2046     		mov	r0, r4
  67 002c 10BD     		pop	{r4, pc}
  68              	.LVL5:
  69              	.L5:
  20:Src/User/motor_driver.c ****     if (HAL_GPIO_ReadPin(M1_HALL_B_GPIO_Port, M1_HALL_B_Pin) == GPIO_PIN_SET)
  70              		.loc 1 20 0
  71 002e 0124     		movs	r4, #1
  72 0030 EEE7     		b	.L2
  73              	.LVL6:
  74              	.L7:
  22:Src/User/motor_driver.c ****         hall |= 0b100;
  75              		.loc 1 22 0
  76 0032 44F00404 		orr	r4, r4, #4
  77              	.LVL7:
  78 0036 F1E7     		b	.L3
  79              	.L8:
  24:Src/User/motor_driver.c ****         hall |= 0b010;
  80              		.loc 1 24 0
  81 0038 44F00204 		orr	r4, r4, #2
  82              	.LVL8:
  83 003c F5E7     		b	.L4
  84              	.L10:
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 3


  85 003e 00BF     		.align	2
  86              	.L9:
  87 0040 00040240 		.word	1073873920
  88 0044 00080240 		.word	1073874944
  89              		.cfi_endproc
  90              	.LFE130:
  92              		.section	.text.mosfet_control,"ax",%progbits
  93              		.align	1
  94              		.global	mosfet_control
  95              		.syntax unified
  96              		.thumb
  97              		.thumb_func
  98              		.fpu fpv4-sp-d16
 100              	mosfet_control:
 101              	.LFB131:
  28:Src/User/motor_driver.c **** 
  29:Src/User/motor_driver.c **** void mosfet_control(uint8_t n, mosfet_state_t s)
  30:Src/User/motor_driver.c **** {
 102              		.loc 1 30 0
 103              		.cfi_startproc
 104              		@ args = 0, pretend = 0, frame = 0
 105              		@ frame_needed = 0, uses_anonymous_args = 0
 106              	.LVL9:
 107 0000 10B5     		push	{r4, lr}
 108              	.LCFI1:
 109              		.cfi_def_cfa_offset 8
 110              		.cfi_offset 4, -8
 111              		.cfi_offset 14, -4
  31:Src/User/motor_driver.c ****     switch (n)
 112              		.loc 1 31 0
 113 0002 0228     		cmp	r0, #2
 114 0004 47D0     		beq	.L13
 115 0006 0328     		cmp	r0, #3
 116 0008 00F08280 		beq	.L14
 117 000c 0128     		cmp	r0, #1
 118 000e 06D0     		beq	.L25
  32:Src/User/motor_driver.c ****     {
  33:Src/User/motor_driver.c ****     case 1:
  34:Src/User/motor_driver.c ****         if (s == HIGH_OFF_LOW_ON)
  35:Src/User/motor_driver.c ****         {
  36:Src/User/motor_driver.c ****             HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_1);
  37:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_1);
  38:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_1, PWM_DUTYCYCLE2PULSE(0));
  39:Src/User/motor_driver.c ****         }
  40:Src/User/motor_driver.c ****         else if (s == HIGH_ON_LOW_OFF)
  41:Src/User/motor_driver.c ****         {
  42:Src/User/motor_driver.c ****             HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_1);
  43:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_1);
  44:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_1, PWM_DUTYCYCLE2PULSE(abs(motor.pwm_buffer))
  45:Src/User/motor_driver.c ****         }
  46:Src/User/motor_driver.c ****         else if (s == HIGH_OFF_LOW_OFF)
  47:Src/User/motor_driver.c ****         {
  48:Src/User/motor_driver.c ****             HAL_TIM_PWM_Stop(&htim1, TIM_CHANNEL_1);
  49:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Stop(&htim1, TIM_CHANNEL_1);
  50:Src/User/motor_driver.c ****         }
  51:Src/User/motor_driver.c ****         break;
  52:Src/User/motor_driver.c **** 
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 4


  53:Src/User/motor_driver.c ****     case 2:
  54:Src/User/motor_driver.c ****         if (s == HIGH_OFF_LOW_ON)
  55:Src/User/motor_driver.c ****         {
  56:Src/User/motor_driver.c ****             HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_2);
  57:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_2);
  58:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, PWM_DUTYCYCLE2PULSE(0));
  59:Src/User/motor_driver.c ****         }
  60:Src/User/motor_driver.c ****         else if (s == HIGH_ON_LOW_OFF)
  61:Src/User/motor_driver.c ****         {
  62:Src/User/motor_driver.c ****             HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_2);
  63:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_2);
  64:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, PWM_DUTYCYCLE2PULSE(abs(motor.pwm_buffer))
  65:Src/User/motor_driver.c ****         }
  66:Src/User/motor_driver.c ****         else if (s == HIGH_OFF_LOW_OFF)
  67:Src/User/motor_driver.c ****         {
  68:Src/User/motor_driver.c ****             HAL_TIM_PWM_Stop(&htim1, TIM_CHANNEL_2);
  69:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Stop(&htim1, TIM_CHANNEL_2);
  70:Src/User/motor_driver.c ****         }
  71:Src/User/motor_driver.c ****         break;
  72:Src/User/motor_driver.c **** 
  73:Src/User/motor_driver.c ****     case 3:
  74:Src/User/motor_driver.c ****         if (s == HIGH_OFF_LOW_ON)
  75:Src/User/motor_driver.c ****         {
  76:Src/User/motor_driver.c ****             HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_3);
  77:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_3);
  78:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_3, PWM_DUTYCYCLE2PULSE(0));
  79:Src/User/motor_driver.c ****         }
  80:Src/User/motor_driver.c ****         else if (s == HIGH_ON_LOW_OFF)
  81:Src/User/motor_driver.c ****         {
  82:Src/User/motor_driver.c ****             HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_3);
  83:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_3);
  84:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_3, PWM_DUTYCYCLE2PULSE(abs(motor.pwm_buffer))
  85:Src/User/motor_driver.c ****         }
  86:Src/User/motor_driver.c ****         else if (s == HIGH_OFF_LOW_OFF)
  87:Src/User/motor_driver.c ****         {
  88:Src/User/motor_driver.c ****             HAL_TIM_PWM_Stop(&htim1, TIM_CHANNEL_3);
  89:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Stop(&htim1, TIM_CHANNEL_3);
  90:Src/User/motor_driver.c ****         }
  91:Src/User/motor_driver.c ****         break;
  92:Src/User/motor_driver.c **** 
  93:Src/User/motor_driver.c ****     default:
  94:Src/User/motor_driver.c ****         __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_1, 0);
 119              		.loc 1 94 0
 120 0010 5E4B     		ldr	r3, .L32
 121 0012 1B68     		ldr	r3, [r3]
 122 0014 0022     		movs	r2, #0
 123 0016 5A63     		str	r2, [r3, #52]
  95:Src/User/motor_driver.c ****         __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, 0);
 124              		.loc 1 95 0
 125 0018 9A63     		str	r2, [r3, #56]
  96:Src/User/motor_driver.c ****         __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_3, 0);
 126              		.loc 1 96 0
 127 001a DA63     		str	r2, [r3, #60]
 128              	.L11:
 129 001c 10BD     		pop	{r4, pc}
 130              	.L25:
  34:Src/User/motor_driver.c ****         {
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 5


 131              		.loc 1 34 0
 132 001e 0129     		cmp	r1, #1
 133 0020 0CD0     		beq	.L26
  40:Src/User/motor_driver.c ****         {
 134              		.loc 1 40 0
 135 0022 C1B1     		cbz	r1, .L27
  46:Src/User/motor_driver.c ****         {
 136              		.loc 1 46 0
 137 0024 0229     		cmp	r1, #2
 138 0026 F9D1     		bne	.L11
  48:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Stop(&htim1, TIM_CHANNEL_1);
 139              		.loc 1 48 0
 140 0028 584C     		ldr	r4, .L32
 141 002a 0021     		movs	r1, #0
 142              	.LVL10:
 143 002c 2046     		mov	r0, r4
 144              	.LVL11:
 145 002e FFF7FEFF 		bl	HAL_TIM_PWM_Stop
 146              	.LVL12:
  49:Src/User/motor_driver.c ****         }
 147              		.loc 1 49 0
 148 0032 0021     		movs	r1, #0
 149 0034 2046     		mov	r0, r4
 150 0036 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Stop
 151              	.LVL13:
 152 003a 10BD     		pop	{r4, pc}
 153              	.LVL14:
 154              	.L26:
  36:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_1);
 155              		.loc 1 36 0
 156 003c 534C     		ldr	r4, .L32
 157 003e 0021     		movs	r1, #0
 158              	.LVL15:
 159 0040 2046     		mov	r0, r4
 160              	.LVL16:
 161 0042 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 162              	.LVL17:
  37:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_1, PWM_DUTYCYCLE2PULSE(0));
 163              		.loc 1 37 0
 164 0046 0021     		movs	r1, #0
 165 0048 2046     		mov	r0, r4
 166 004a FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 167              	.LVL18:
  38:Src/User/motor_driver.c ****         }
 168              		.loc 1 38 0
 169 004e 2368     		ldr	r3, [r4]
 170 0050 0022     		movs	r2, #0
 171 0052 5A63     		str	r2, [r3, #52]
 172 0054 10BD     		pop	{r4, pc}
 173              	.LVL19:
 174              	.L27:
  42:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_1);
 175              		.loc 1 42 0
 176 0056 4D4C     		ldr	r4, .L32
 177 0058 2046     		mov	r0, r4
 178              	.LVL20:
 179 005a FFF7FEFF 		bl	HAL_TIM_PWM_Start
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 6


 180              	.LVL21:
  43:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_1, PWM_DUTYCYCLE2PULSE(abs(motor.pwm_buffer))
 181              		.loc 1 43 0
 182 005e 0021     		movs	r1, #0
 183 0060 2046     		mov	r0, r4
 184 0062 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 185              	.LVL22:
  44:Src/User/motor_driver.c ****         }
 186              		.loc 1 44 0
 187 0066 2268     		ldr	r2, [r4]
 188 0068 494B     		ldr	r3, .L32+4
 189 006a 93F90130 		ldrsb	r3, [r3, #1]
 190 006e 002B     		cmp	r3, #0
 191 0070 B8BF     		it	lt
 192 0072 5B42     		rsblt	r3, r3, #0
 193 0074 07EE903A 		vmov	s15, r3	@ int
 194 0078 B8EEE77A 		vcvt.f32.s32	s14, s15
 195 007c DFED456A 		vldr.32	s13, .L32+8
 196 0080 C7EE267A 		vdiv.f32	s15, s14, s13
 197 0084 9FED447A 		vldr.32	s14, .L32+12
 198 0088 67EE877A 		vmul.f32	s15, s15, s14
 199 008c FCEEE77A 		vcvt.u32.f32	s15, s15
 200 0090 C2ED0D7A 		vstr.32	s15, [r2, #52]	@ int
 201 0094 10BD     		pop	{r4, pc}
 202              	.LVL23:
 203              	.L13:
  54:Src/User/motor_driver.c ****         {
 204              		.loc 1 54 0
 205 0096 0129     		cmp	r1, #1
 206 0098 0CD0     		beq	.L28
  60:Src/User/motor_driver.c ****         {
 207              		.loc 1 60 0
 208 009a C1B1     		cbz	r1, .L29
  66:Src/User/motor_driver.c ****         {
 209              		.loc 1 66 0
 210 009c 0229     		cmp	r1, #2
 211 009e BDD1     		bne	.L11
  68:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Stop(&htim1, TIM_CHANNEL_2);
 212              		.loc 1 68 0
 213 00a0 3A4C     		ldr	r4, .L32
 214 00a2 0421     		movs	r1, #4
 215              	.LVL24:
 216 00a4 2046     		mov	r0, r4
 217              	.LVL25:
 218 00a6 FFF7FEFF 		bl	HAL_TIM_PWM_Stop
 219              	.LVL26:
  69:Src/User/motor_driver.c ****         }
 220              		.loc 1 69 0
 221 00aa 0421     		movs	r1, #4
 222 00ac 2046     		mov	r0, r4
 223 00ae FFF7FEFF 		bl	HAL_TIMEx_PWMN_Stop
 224              	.LVL27:
 225 00b2 10BD     		pop	{r4, pc}
 226              	.LVL28:
 227              	.L28:
  56:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_2);
 228              		.loc 1 56 0
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 7


 229 00b4 354C     		ldr	r4, .L32
 230 00b6 0421     		movs	r1, #4
 231              	.LVL29:
 232 00b8 2046     		mov	r0, r4
 233              	.LVL30:
 234 00ba FFF7FEFF 		bl	HAL_TIM_PWM_Start
 235              	.LVL31:
  57:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, PWM_DUTYCYCLE2PULSE(0));
 236              		.loc 1 57 0
 237 00be 0421     		movs	r1, #4
 238 00c0 2046     		mov	r0, r4
 239 00c2 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 240              	.LVL32:
  58:Src/User/motor_driver.c ****         }
 241              		.loc 1 58 0
 242 00c6 2368     		ldr	r3, [r4]
 243 00c8 0022     		movs	r2, #0
 244 00ca 9A63     		str	r2, [r3, #56]
 245 00cc 10BD     		pop	{r4, pc}
 246              	.LVL33:
 247              	.L29:
  62:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_2);
 248              		.loc 1 62 0
 249 00ce 2F4C     		ldr	r4, .L32
 250 00d0 0421     		movs	r1, #4
 251              	.LVL34:
 252 00d2 2046     		mov	r0, r4
 253              	.LVL35:
 254 00d4 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 255              	.LVL36:
  63:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, PWM_DUTYCYCLE2PULSE(abs(motor.pwm_buffer))
 256              		.loc 1 63 0
 257 00d8 0421     		movs	r1, #4
 258 00da 2046     		mov	r0, r4
 259 00dc FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 260              	.LVL37:
  64:Src/User/motor_driver.c ****         }
 261              		.loc 1 64 0
 262 00e0 2268     		ldr	r2, [r4]
 263 00e2 2B4B     		ldr	r3, .L32+4
 264 00e4 93F90130 		ldrsb	r3, [r3, #1]
 265 00e8 002B     		cmp	r3, #0
 266 00ea B8BF     		it	lt
 267 00ec 5B42     		rsblt	r3, r3, #0
 268 00ee 07EE903A 		vmov	s15, r3	@ int
 269 00f2 B8EEE77A 		vcvt.f32.s32	s14, s15
 270 00f6 DFED276A 		vldr.32	s13, .L32+8
 271 00fa C7EE267A 		vdiv.f32	s15, s14, s13
 272 00fe 9FED267A 		vldr.32	s14, .L32+12
 273 0102 67EE877A 		vmul.f32	s15, s15, s14
 274 0106 FCEEE77A 		vcvt.u32.f32	s15, s15
 275 010a C2ED0E7A 		vstr.32	s15, [r2, #56]	@ int
 276 010e 10BD     		pop	{r4, pc}
 277              	.LVL38:
 278              	.L14:
  74:Src/User/motor_driver.c ****         {
 279              		.loc 1 74 0
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 8


 280 0110 0129     		cmp	r1, #1
 281 0112 0CD0     		beq	.L30
  80:Src/User/motor_driver.c ****         {
 282              		.loc 1 80 0
 283 0114 C1B1     		cbz	r1, .L31
  86:Src/User/motor_driver.c ****         {
 284              		.loc 1 86 0
 285 0116 0229     		cmp	r1, #2
 286 0118 80D1     		bne	.L11
  88:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Stop(&htim1, TIM_CHANNEL_3);
 287              		.loc 1 88 0
 288 011a 1C4C     		ldr	r4, .L32
 289 011c 0821     		movs	r1, #8
 290              	.LVL39:
 291 011e 2046     		mov	r0, r4
 292              	.LVL40:
 293 0120 FFF7FEFF 		bl	HAL_TIM_PWM_Stop
 294              	.LVL41:
  89:Src/User/motor_driver.c ****         }
 295              		.loc 1 89 0
 296 0124 0821     		movs	r1, #8
 297 0126 2046     		mov	r0, r4
 298 0128 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Stop
 299              	.LVL42:
 300 012c 10BD     		pop	{r4, pc}
 301              	.LVL43:
 302              	.L30:
  76:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_3);
 303              		.loc 1 76 0
 304 012e 174C     		ldr	r4, .L32
 305 0130 0821     		movs	r1, #8
 306              	.LVL44:
 307 0132 2046     		mov	r0, r4
 308              	.LVL45:
 309 0134 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 310              	.LVL46:
  77:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_3, PWM_DUTYCYCLE2PULSE(0));
 311              		.loc 1 77 0
 312 0138 0821     		movs	r1, #8
 313 013a 2046     		mov	r0, r4
 314 013c FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 315              	.LVL47:
  78:Src/User/motor_driver.c ****         }
 316              		.loc 1 78 0
 317 0140 2368     		ldr	r3, [r4]
 318 0142 0022     		movs	r2, #0
 319 0144 DA63     		str	r2, [r3, #60]
 320 0146 10BD     		pop	{r4, pc}
 321              	.LVL48:
 322              	.L31:
  82:Src/User/motor_driver.c ****             HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_3);
 323              		.loc 1 82 0
 324 0148 104C     		ldr	r4, .L32
 325 014a 0821     		movs	r1, #8
 326              	.LVL49:
 327 014c 2046     		mov	r0, r4
 328              	.LVL50:
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 9


 329 014e FFF7FEFF 		bl	HAL_TIM_PWM_Start
 330              	.LVL51:
  83:Src/User/motor_driver.c ****             __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_3, PWM_DUTYCYCLE2PULSE(abs(motor.pwm_buffer))
 331              		.loc 1 83 0
 332 0152 0821     		movs	r1, #8
 333 0154 2046     		mov	r0, r4
 334 0156 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 335              	.LVL52:
  84:Src/User/motor_driver.c ****         }
 336              		.loc 1 84 0
 337 015a 2268     		ldr	r2, [r4]
 338 015c 0C4B     		ldr	r3, .L32+4
 339 015e 93F90130 		ldrsb	r3, [r3, #1]
 340 0162 002B     		cmp	r3, #0
 341 0164 B8BF     		it	lt
 342 0166 5B42     		rsblt	r3, r3, #0
 343 0168 07EE903A 		vmov	s15, r3	@ int
 344 016c B8EEE77A 		vcvt.f32.s32	s14, s15
 345 0170 DFED086A 		vldr.32	s13, .L32+8
 346 0174 C7EE267A 		vdiv.f32	s15, s14, s13
 347 0178 9FED077A 		vldr.32	s14, .L32+12
 348 017c 67EE877A 		vmul.f32	s15, s15, s14
 349 0180 FCEEE77A 		vcvt.u32.f32	s15, s15
 350 0184 C2ED0F7A 		vstr.32	s15, [r2, #60]	@ int
 351 0188 10BD     		pop	{r4, pc}
 352              	.L33:
 353 018a 00BF     		.align	2
 354              	.L32:
 355 018c 00000000 		.word	htim1
 356 0190 00000000 		.word	motor
 357 0194 0000C842 		.word	1120403456
 358 0198 00007C42 		.word	1115422720
 359              		.cfi_endproc
 360              	.LFE131:
 362              		.section	.text.phase_select,"ax",%progbits
 363              		.align	1
 364              		.global	phase_select
 365              		.syntax unified
 366              		.thumb
 367              		.thumb_func
 368              		.fpu fpv4-sp-d16
 370              	phase_select:
 371              	.LFB132:
  97:Src/User/motor_driver.c ****         break;
  98:Src/User/motor_driver.c ****     }
  99:Src/User/motor_driver.c **** }
 100:Src/User/motor_driver.c **** 
 101:Src/User/motor_driver.c **** void phase_select(uint8_t phase)
 102:Src/User/motor_driver.c **** {
 372              		.loc 1 102 0
 373              		.cfi_startproc
 374              		@ args = 0, pretend = 0, frame = 0
 375              		@ frame_needed = 0, uses_anonymous_args = 0
 376              	.LVL53:
 377 0000 08B5     		push	{r3, lr}
 378              	.LCFI2:
 379              		.cfi_def_cfa_offset 8
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 10


 380              		.cfi_offset 3, -8
 381              		.cfi_offset 14, -4
 103:Src/User/motor_driver.c ****     switch (phase)
 382              		.loc 1 103 0
 383 0002 0628     		cmp	r0, #6
 384 0004 5FD8     		bhi	.L34
 385 0006 DFE800F0 		tbb	[pc, r0]
 386              	.L37:
 387 000a 04       		.byte	(.L36-.L37)/2
 388 000b 11       		.byte	(.L38-.L37)/2
 389 000c 1E       		.byte	(.L39-.L37)/2
 390 000d 2B       		.byte	(.L40-.L37)/2
 391 000e 38       		.byte	(.L41-.L37)/2
 392 000f 45       		.byte	(.L42-.L37)/2
 393 0010 52       		.byte	(.L43-.L37)/2
 394 0011 00       		.p2align 1
 395              	.L36:
 104:Src/User/motor_driver.c ****     {
 105:Src/User/motor_driver.c ****     case 0:
 106:Src/User/motor_driver.c ****         mosfet_control(1, HIGH_OFF_LOW_OFF);
 396              		.loc 1 106 0
 397 0012 0221     		movs	r1, #2
 398 0014 0120     		movs	r0, #1
 399              	.LVL54:
 400 0016 FFF7FEFF 		bl	mosfet_control
 401              	.LVL55:
 107:Src/User/motor_driver.c ****         mosfet_control(2, HIGH_OFF_LOW_OFF);
 402              		.loc 1 107 0
 403 001a 0221     		movs	r1, #2
 404 001c 0846     		mov	r0, r1
 405 001e FFF7FEFF 		bl	mosfet_control
 406              	.LVL56:
 108:Src/User/motor_driver.c ****         mosfet_control(3, HIGH_OFF_LOW_OFF);
 407              		.loc 1 108 0
 408 0022 0221     		movs	r1, #2
 409 0024 0320     		movs	r0, #3
 410 0026 FFF7FEFF 		bl	mosfet_control
 411              	.LVL57:
 109:Src/User/motor_driver.c ****         break;
 412              		.loc 1 109 0
 413 002a 08BD     		pop	{r3, pc}
 414              	.LVL58:
 415              	.L38:
 110:Src/User/motor_driver.c **** 
 111:Src/User/motor_driver.c ****     case 1: //AB
 112:Src/User/motor_driver.c ****         mosfet_control(1, HIGH_ON_LOW_OFF);
 416              		.loc 1 112 0
 417 002c 0021     		movs	r1, #0
 418 002e 0120     		movs	r0, #1
 419              	.LVL59:
 420 0030 FFF7FEFF 		bl	mosfet_control
 421              	.LVL60:
 113:Src/User/motor_driver.c ****         mosfet_control(2, HIGH_OFF_LOW_ON);
 422              		.loc 1 113 0
 423 0034 0121     		movs	r1, #1
 424 0036 0220     		movs	r0, #2
 425 0038 FFF7FEFF 		bl	mosfet_control
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 11


 426              	.LVL61:
 114:Src/User/motor_driver.c ****         mosfet_control(3, HIGH_OFF_LOW_OFF);
 427              		.loc 1 114 0
 428 003c 0221     		movs	r1, #2
 429 003e 0320     		movs	r0, #3
 430 0040 FFF7FEFF 		bl	mosfet_control
 431              	.LVL62:
 115:Src/User/motor_driver.c ****         break;
 432              		.loc 1 115 0
 433 0044 08BD     		pop	{r3, pc}
 434              	.LVL63:
 435              	.L39:
 116:Src/User/motor_driver.c **** 
 117:Src/User/motor_driver.c ****     case 2: //CB
 118:Src/User/motor_driver.c ****         mosfet_control(1, HIGH_OFF_LOW_OFF);
 436              		.loc 1 118 0
 437 0046 0221     		movs	r1, #2
 438 0048 0120     		movs	r0, #1
 439              	.LVL64:
 440 004a FFF7FEFF 		bl	mosfet_control
 441              	.LVL65:
 119:Src/User/motor_driver.c ****         mosfet_control(2, HIGH_OFF_LOW_ON);
 442              		.loc 1 119 0
 443 004e 0121     		movs	r1, #1
 444 0050 0220     		movs	r0, #2
 445 0052 FFF7FEFF 		bl	mosfet_control
 446              	.LVL66:
 120:Src/User/motor_driver.c ****         mosfet_control(3, HIGH_ON_LOW_OFF);
 447              		.loc 1 120 0
 448 0056 0021     		movs	r1, #0
 449 0058 0320     		movs	r0, #3
 450 005a FFF7FEFF 		bl	mosfet_control
 451              	.LVL67:
 121:Src/User/motor_driver.c ****         break;
 452              		.loc 1 121 0
 453 005e 08BD     		pop	{r3, pc}
 454              	.LVL68:
 455              	.L40:
 122:Src/User/motor_driver.c **** 
 123:Src/User/motor_driver.c ****     case 3: //CA
 124:Src/User/motor_driver.c ****         mosfet_control(1, HIGH_OFF_LOW_ON);
 456              		.loc 1 124 0
 457 0060 0121     		movs	r1, #1
 458 0062 0846     		mov	r0, r1
 459              	.LVL69:
 460 0064 FFF7FEFF 		bl	mosfet_control
 461              	.LVL70:
 125:Src/User/motor_driver.c ****         mosfet_control(2, HIGH_OFF_LOW_OFF);
 462              		.loc 1 125 0
 463 0068 0221     		movs	r1, #2
 464 006a 0846     		mov	r0, r1
 465 006c FFF7FEFF 		bl	mosfet_control
 466              	.LVL71:
 126:Src/User/motor_driver.c ****         mosfet_control(3, HIGH_ON_LOW_OFF);
 467              		.loc 1 126 0
 468 0070 0021     		movs	r1, #0
 469 0072 0320     		movs	r0, #3
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 12


 470 0074 FFF7FEFF 		bl	mosfet_control
 471              	.LVL72:
 127:Src/User/motor_driver.c ****         break;
 472              		.loc 1 127 0
 473 0078 08BD     		pop	{r3, pc}
 474              	.LVL73:
 475              	.L41:
 128:Src/User/motor_driver.c **** 
 129:Src/User/motor_driver.c ****     case 4: //BA
 130:Src/User/motor_driver.c ****         mosfet_control(1, HIGH_OFF_LOW_ON);
 476              		.loc 1 130 0
 477 007a 0121     		movs	r1, #1
 478 007c 0846     		mov	r0, r1
 479              	.LVL74:
 480 007e FFF7FEFF 		bl	mosfet_control
 481              	.LVL75:
 131:Src/User/motor_driver.c ****         mosfet_control(2, HIGH_ON_LOW_OFF);
 482              		.loc 1 131 0
 483 0082 0021     		movs	r1, #0
 484 0084 0220     		movs	r0, #2
 485 0086 FFF7FEFF 		bl	mosfet_control
 486              	.LVL76:
 132:Src/User/motor_driver.c ****         mosfet_control(3, HIGH_OFF_LOW_OFF);
 487              		.loc 1 132 0
 488 008a 0221     		movs	r1, #2
 489 008c 0320     		movs	r0, #3
 490 008e FFF7FEFF 		bl	mosfet_control
 491              	.LVL77:
 133:Src/User/motor_driver.c ****         break;
 492              		.loc 1 133 0
 493 0092 08BD     		pop	{r3, pc}
 494              	.LVL78:
 495              	.L42:
 134:Src/User/motor_driver.c **** 
 135:Src/User/motor_driver.c ****     case 5: //BC
 136:Src/User/motor_driver.c ****         mosfet_control(1, HIGH_OFF_LOW_OFF);
 496              		.loc 1 136 0
 497 0094 0221     		movs	r1, #2
 498 0096 0120     		movs	r0, #1
 499              	.LVL79:
 500 0098 FFF7FEFF 		bl	mosfet_control
 501              	.LVL80:
 137:Src/User/motor_driver.c ****         mosfet_control(2, HIGH_ON_LOW_OFF);
 502              		.loc 1 137 0
 503 009c 0021     		movs	r1, #0
 504 009e 0220     		movs	r0, #2
 505 00a0 FFF7FEFF 		bl	mosfet_control
 506              	.LVL81:
 138:Src/User/motor_driver.c ****         mosfet_control(3, HIGH_OFF_LOW_ON);
 507              		.loc 1 138 0
 508 00a4 0121     		movs	r1, #1
 509 00a6 0320     		movs	r0, #3
 510 00a8 FFF7FEFF 		bl	mosfet_control
 511              	.LVL82:
 139:Src/User/motor_driver.c ****         break;
 512              		.loc 1 139 0
 513 00ac 08BD     		pop	{r3, pc}
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 13


 514              	.LVL83:
 515              	.L43:
 140:Src/User/motor_driver.c **** 
 141:Src/User/motor_driver.c ****     case 6: //AC
 142:Src/User/motor_driver.c ****         mosfet_control(1, HIGH_ON_LOW_OFF);
 516              		.loc 1 142 0
 517 00ae 0021     		movs	r1, #0
 518 00b0 0120     		movs	r0, #1
 519              	.LVL84:
 520 00b2 FFF7FEFF 		bl	mosfet_control
 521              	.LVL85:
 143:Src/User/motor_driver.c ****         mosfet_control(2, HIGH_OFF_LOW_OFF);
 522              		.loc 1 143 0
 523 00b6 0221     		movs	r1, #2
 524 00b8 0846     		mov	r0, r1
 525 00ba FFF7FEFF 		bl	mosfet_control
 526              	.LVL86:
 144:Src/User/motor_driver.c ****         mosfet_control(3, HIGH_OFF_LOW_ON);
 527              		.loc 1 144 0
 528 00be 0121     		movs	r1, #1
 529 00c0 0320     		movs	r0, #3
 530 00c2 FFF7FEFF 		bl	mosfet_control
 531              	.LVL87:
 532              	.L34:
 533 00c6 08BD     		pop	{r3, pc}
 534              		.cfi_endproc
 535              	.LFE132:
 537              		.section	.text.drv8301_spi_sent,"ax",%progbits
 538              		.align	1
 539              		.global	drv8301_spi_sent
 540              		.syntax unified
 541              		.thumb
 542              		.thumb_func
 543              		.fpu fpv4-sp-d16
 545              	drv8301_spi_sent:
 546              	.LFB133:
 145:Src/User/motor_driver.c ****         break;
 146:Src/User/motor_driver.c **** 
 147:Src/User/motor_driver.c ****     default:
 148:Src/User/motor_driver.c ****         break;
 149:Src/User/motor_driver.c ****     }
 150:Src/User/motor_driver.c **** }
 151:Src/User/motor_driver.c **** 
 152:Src/User/motor_driver.c **** void drv8301_spi_sent()
 153:Src/User/motor_driver.c **** {
 547              		.loc 1 153 0
 548              		.cfi_startproc
 549              		@ args = 0, pretend = 0, frame = 0
 550              		@ frame_needed = 0, uses_anonymous_args = 0
 551 0000 38B5     		push	{r3, r4, r5, lr}
 552              	.LCFI3:
 553              		.cfi_def_cfa_offset 16
 554              		.cfi_offset 3, -16
 555              		.cfi_offset 4, -12
 556              		.cfi_offset 5, -8
 557              		.cfi_offset 14, -4
 154:Src/User/motor_driver.c ****     HAL_GPIO_WritePin(M1_SPI_CS_GPIO_Port, M1_SPI_CS_Pin, GPIO_PIN_RESET);
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 14


 558              		.loc 1 154 0
 559 0002 1B4C     		ldr	r4, .L47
 560 0004 0022     		movs	r2, #0
 561 0006 4FF40051 		mov	r1, #8192
 562 000a 2046     		mov	r0, r4
 563 000c FFF7FEFF 		bl	HAL_GPIO_WritePin
 564              	.LVL88:
 155:Src/User/motor_driver.c ****     HAL_Delay(1);
 565              		.loc 1 155 0
 566 0010 0120     		movs	r0, #1
 567 0012 FFF7FEFF 		bl	HAL_Delay
 568              	.LVL89:
 156:Src/User/motor_driver.c ****     HAL_SPI_Transmit(&hspi3, (uint8_t *)&drv8301_spi_tx_dat, 1, 100);
 569              		.loc 1 156 0
 570 0016 174D     		ldr	r5, .L47+4
 571 0018 6423     		movs	r3, #100
 572 001a 0122     		movs	r2, #1
 573 001c 1649     		ldr	r1, .L47+8
 574 001e 2846     		mov	r0, r5
 575 0020 FFF7FEFF 		bl	HAL_SPI_Transmit
 576              	.LVL90:
 157:Src/User/motor_driver.c ****     HAL_Delay(1);
 577              		.loc 1 157 0
 578 0024 0120     		movs	r0, #1
 579 0026 FFF7FEFF 		bl	HAL_Delay
 580              	.LVL91:
 158:Src/User/motor_driver.c ****     HAL_GPIO_WritePin(M1_SPI_CS_GPIO_Port, M1_SPI_CS_Pin, GPIO_PIN_SET);
 581              		.loc 1 158 0
 582 002a 0122     		movs	r2, #1
 583 002c 4FF40051 		mov	r1, #8192
 584 0030 2046     		mov	r0, r4
 585 0032 FFF7FEFF 		bl	HAL_GPIO_WritePin
 586              	.LVL92:
 159:Src/User/motor_driver.c ****     HAL_Delay(1);
 587              		.loc 1 159 0
 588 0036 0120     		movs	r0, #1
 589 0038 FFF7FEFF 		bl	HAL_Delay
 590              	.LVL93:
 160:Src/User/motor_driver.c ****     HAL_GPIO_WritePin(M1_SPI_CS_GPIO_Port, M1_SPI_CS_Pin, GPIO_PIN_RESET);
 591              		.loc 1 160 0
 592 003c 0022     		movs	r2, #0
 593 003e 4FF40051 		mov	r1, #8192
 594 0042 2046     		mov	r0, r4
 595 0044 FFF7FEFF 		bl	HAL_GPIO_WritePin
 596              	.LVL94:
 161:Src/User/motor_driver.c ****     HAL_Delay(1);
 597              		.loc 1 161 0
 598 0048 0120     		movs	r0, #1
 599 004a FFF7FEFF 		bl	HAL_Delay
 600              	.LVL95:
 162:Src/User/motor_driver.c ****     HAL_SPI_Receive(&hspi3, (uint8_t *)&drv8301_spi_rx_dat, 1, 100);
 601              		.loc 1 162 0
 602 004e 6423     		movs	r3, #100
 603 0050 0122     		movs	r2, #1
 604 0052 0A49     		ldr	r1, .L47+12
 605 0054 2846     		mov	r0, r5
 606 0056 FFF7FEFF 		bl	HAL_SPI_Receive
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 15


 607              	.LVL96:
 163:Src/User/motor_driver.c ****     HAL_Delay(1);
 608              		.loc 1 163 0
 609 005a 0120     		movs	r0, #1
 610 005c FFF7FEFF 		bl	HAL_Delay
 611              	.LVL97:
 164:Src/User/motor_driver.c ****     HAL_GPIO_WritePin(M1_SPI_CS_GPIO_Port, M1_SPI_CS_Pin, GPIO_PIN_SET);
 612              		.loc 1 164 0
 613 0060 0122     		movs	r2, #1
 614 0062 4FF40051 		mov	r1, #8192
 615 0066 2046     		mov	r0, r4
 616 0068 FFF7FEFF 		bl	HAL_GPIO_WritePin
 617              	.LVL98:
 618 006c 38BD     		pop	{r3, r4, r5, pc}
 619              	.L48:
 620 006e 00BF     		.align	2
 621              	.L47:
 622 0070 00080240 		.word	1073874944
 623 0074 00000000 		.word	hspi3
 624 0078 00000000 		.word	drv8301_spi_tx_dat
 625 007c 00000000 		.word	drv8301_spi_rx_dat
 626              		.cfi_endproc
 627              	.LFE133:
 629              		.section	.text.motor_start,"ax",%progbits
 630              		.align	1
 631              		.global	motor_start
 632              		.syntax unified
 633              		.thumb
 634              		.thumb_func
 635              		.fpu fpv4-sp-d16
 637              	motor_start:
 638              	.LFB134:
 165:Src/User/motor_driver.c **** }
 166:Src/User/motor_driver.c **** 
 167:Src/User/motor_driver.c **** void motor_start()
 168:Src/User/motor_driver.c **** {
 639              		.loc 1 168 0
 640              		.cfi_startproc
 641              		@ args = 0, pretend = 0, frame = 0
 642              		@ frame_needed = 0, uses_anonymous_args = 0
 643 0000 08B5     		push	{r3, lr}
 644              	.LCFI4:
 645              		.cfi_def_cfa_offset 8
 646              		.cfi_offset 3, -8
 647              		.cfi_offset 14, -4
 169:Src/User/motor_driver.c ****     // while (read_hall() == 0b000 || read_hall() == 0b111)
 170:Src/User/motor_driver.c ****     //     ;
 171:Src/User/motor_driver.c **** 
 172:Src/User/motor_driver.c ****     /*---------------------------------------------------------------------------------------------
 173:Src/User/motor_driver.c ****     // HAL_SPI_Transmit(&hspi3, (uint8_t *)&drv8301_spi_tx_dat, 1, 100); //dummy transmition to mak
 174:Src/User/motor_driver.c **** 
 175:Src/User/motor_driver.c ****     HAL_GPIO_WritePin(EN_GATE_GPIO_Port, EN_GATE_Pin, GPIO_PIN_SET);
 648              		.loc 1 175 0
 649 0002 0122     		movs	r2, #1
 650 0004 4FF48051 		mov	r1, #4096
 651 0008 0948     		ldr	r0, .L51
 652 000a FFF7FEFF 		bl	HAL_GPIO_WritePin
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 16


 653              	.LVL99:
 176:Src/User/motor_driver.c **** 
 177:Src/User/motor_driver.c ****     // HAL_Delay(10);
 178:Src/User/motor_driver.c ****     // drv8301_spi_tx_dat = DRV8301_GET_SPI_FRAME(DRV8301_MODE_W, DRV8301_ADDRESS_CONTROL2, 0b00000
 179:Src/User/motor_driver.c ****     // drv8301_spi_tx_dat = DRV8301_GET_SPI_FRAME(DRV8301_MODE_R, DRV8301_ADDRESS_STATUS0, 0b000000
 180:Src/User/motor_driver.c ****     // drv8301_spi_sent();
 181:Src/User/motor_driver.c ****     // HAL_Delay(10);
 182:Src/User/motor_driver.c **** 
 183:Src/User/motor_driver.c ****     // HAL_ADC_Start_DMA(&hadc1, (uint32_t *)&adc_result_raw, 1);
 184:Src/User/motor_driver.c ****     // HAL_ADC_Start_DMA(&hadc2, (uint32_t *)&adc_result_raw, 1);
 185:Src/User/motor_driver.c ****     // HAL_TIM_Base_Start_IT(&htim6);      //for ADC1 and ADC2 sampling triger
 186:Src/User/motor_driver.c **** 
 187:Src/User/motor_driver.c ****     // HAL_Delay(5);
 188:Src/User/motor_driver.c ****     // current_dc_offset = motor.current - CURRENT_LINEAR_OFFSET;
 189:Src/User/motor_driver.c **** 
 190:Src/User/motor_driver.c ****     // drv8301_spi_tx_dat = DRV8301_GET_SPI_FRAME(DRV8301_MODE_W, DRV8301_ADDRESS_CONTROL2, 0b00000
 191:Src/User/motor_driver.c ****     // drv8301_spi_sent();
 192:Src/User/motor_driver.c ****     /*---------------------------------------------------------------------------------------------
 193:Src/User/motor_driver.c ****     // pid_init(&motor_pid_current, 5, 50, 50, 50.0f, 5.0f, 0.5f);
 194:Src/User/motor_driver.c ****     pid_init(&motor_pid_speed, -15, 15, 15, 2.8f, 0.0f, 0.0f);
 654              		.loc 1 194 0
 655 000e 9FED092A 		vldr.32	s4, .L51+4
 656 0012 F0EE422A 		vmov.f32	s5, s4
 657 0016 DFED081A 		vldr.32	s3, .L51+8
 658 001a B2EE0E1A 		vmov.f32	s2, #1.5e+1
 659 001e F0EE410A 		vmov.f32	s1, s2
 660 0022 BAEE0E0A 		vmov.f32	s0, #-1.5e+1
 661 0026 0548     		ldr	r0, .L51+12
 662 0028 FFF7FEFF 		bl	pid_init
 663              	.LVL100:
 664 002c 08BD     		pop	{r3, pc}
 665              	.L52:
 666 002e 00BF     		.align	2
 667              	.L51:
 668 0030 00040240 		.word	1073873920
 669 0034 00000000 		.word	0
 670 0038 33333340 		.word	1077097267
 671 003c 00000000 		.word	motor_pid_speed
 672              		.cfi_endproc
 673              	.LFE134:
 675              		.section	.text.motor_stop,"ax",%progbits
 676              		.align	1
 677              		.global	motor_stop
 678              		.syntax unified
 679              		.thumb
 680              		.thumb_func
 681              		.fpu fpv4-sp-d16
 683              	motor_stop:
 684              	.LFB135:
 195:Src/User/motor_driver.c ****     // pid_init(&motor_pid_position, -50, 50, 50, 3.0f, 0.3f, 0.0f);
 196:Src/User/motor_driver.c **** 
 197:Src/User/motor_driver.c ****     // motor_change_phase();
 198:Src/User/motor_driver.c **** }
 199:Src/User/motor_driver.c **** 
 200:Src/User/motor_driver.c **** void motor_stop()
 201:Src/User/motor_driver.c **** {
 685              		.loc 1 201 0
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 17


 686              		.cfi_startproc
 687              		@ args = 0, pretend = 0, frame = 0
 688              		@ frame_needed = 0, uses_anonymous_args = 0
 689 0000 08B5     		push	{r3, lr}
 690              	.LCFI5:
 691              		.cfi_def_cfa_offset 8
 692              		.cfi_offset 3, -8
 693              		.cfi_offset 14, -4
 202:Src/User/motor_driver.c ****     phase_select(0);
 694              		.loc 1 202 0
 695 0002 0020     		movs	r0, #0
 696 0004 FFF7FEFF 		bl	phase_select
 697              	.LVL101:
 203:Src/User/motor_driver.c **** 
 204:Src/User/motor_driver.c ****     HAL_GPIO_WritePin(EN_GATE_GPIO_Port, EN_GATE_Pin, GPIO_PIN_RESET);
 698              		.loc 1 204 0
 699 0008 0022     		movs	r2, #0
 700 000a 4FF48051 		mov	r1, #4096
 701 000e 0248     		ldr	r0, .L55
 702 0010 FFF7FEFF 		bl	HAL_GPIO_WritePin
 703              	.LVL102:
 704 0014 08BD     		pop	{r3, pc}
 705              	.L56:
 706 0016 00BF     		.align	2
 707              	.L55:
 708 0018 00040240 		.word	1073873920
 709              		.cfi_endproc
 710              	.LFE135:
 712              		.section	.text.motor_change_phase,"ax",%progbits
 713              		.align	1
 714              		.global	motor_change_phase
 715              		.syntax unified
 716              		.thumb
 717              		.thumb_func
 718              		.fpu fpv4-sp-d16
 720              	motor_change_phase:
 721              	.LFB136:
 205:Src/User/motor_driver.c **** 
 206:Src/User/motor_driver.c ****     // HAL_ADC_Stop_DMA(&hadc1);
 207:Src/User/motor_driver.c ****     // HAL_TIM_Base_Stop_IT(&htim3);
 208:Src/User/motor_driver.c **** }
 209:Src/User/motor_driver.c **** 
 210:Src/User/motor_driver.c **** uint8_t hall;
 211:Src/User/motor_driver.c **** void motor_change_phase()
 212:Src/User/motor_driver.c **** {
 722              		.loc 1 212 0
 723              		.cfi_startproc
 724              		@ args = 0, pretend = 0, frame = 0
 725              		@ frame_needed = 0, uses_anonymous_args = 0
 726 0000 08B5     		push	{r3, lr}
 727              	.LCFI6:
 728              		.cfi_def_cfa_offset 8
 729              		.cfi_offset 3, -8
 730              		.cfi_offset 14, -4
 213:Src/User/motor_driver.c ****     hall = read_hall();
 731              		.loc 1 213 0
 732 0002 FFF7FEFF 		bl	read_hall
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 18


 733              	.LVL103:
 734 0006 0D4B     		ldr	r3, .L63
 735 0008 1870     		strb	r0, [r3]
 214:Src/User/motor_driver.c ****     if (motor.pwm_buffer > 0)
 736              		.loc 1 214 0
 737 000a 0D4B     		ldr	r3, .L63+4
 738 000c 93F90130 		ldrsb	r3, [r3, #1]
 739 0010 002B     		cmp	r3, #0
 740 0012 02DC     		bgt	.L61
 215:Src/User/motor_driver.c ****         phase_select(hall_state_sequence[7 - read_hall()]);
 216:Src/User/motor_driver.c ****     else if (motor.pwm_buffer < 0)
 741              		.loc 1 216 0
 742 0014 002B     		cmp	r3, #0
 743 0016 09DB     		blt	.L62
 744              	.L57:
 745 0018 08BD     		pop	{r3, pc}
 746              	.L61:
 215:Src/User/motor_driver.c ****         phase_select(hall_state_sequence[7 - read_hall()]);
 747              		.loc 1 215 0
 748 001a FFF7FEFF 		bl	read_hall
 749              	.LVL104:
 750 001e C0F10700 		rsb	r0, r0, #7
 751 0022 084B     		ldr	r3, .L63+8
 752 0024 185C     		ldrb	r0, [r3, r0]	@ zero_extendqisi2
 753 0026 FFF7FEFF 		bl	phase_select
 754              	.LVL105:
 755 002a 08BD     		pop	{r3, pc}
 756              	.L62:
 217:Src/User/motor_driver.c ****         phase_select(hall_state_sequence[read_hall()]);
 757              		.loc 1 217 0
 758 002c FFF7FEFF 		bl	read_hall
 759              	.LVL106:
 760 0030 044B     		ldr	r3, .L63+8
 761 0032 185C     		ldrb	r0, [r3, r0]	@ zero_extendqisi2
 762 0034 FFF7FEFF 		bl	phase_select
 763              	.LVL107:
 218:Src/User/motor_driver.c **** }
 764              		.loc 1 218 0
 765 0038 EEE7     		b	.L57
 766              	.L64:
 767 003a 00BF     		.align	2
 768              	.L63:
 769 003c 00000000 		.word	hall
 770 0040 00000000 		.word	motor
 771 0044 00000000 		.word	.LANCHOR0
 772              		.cfi_endproc
 773              	.LFE136:
 775              		.section	.text.motor_get_speed,"ax",%progbits
 776              		.align	1
 777              		.global	motor_get_speed
 778              		.syntax unified
 779              		.thumb
 780              		.thumb_func
 781              		.fpu fpv4-sp-d16
 783              	motor_get_speed:
 784              	.LFB137:
 219:Src/User/motor_driver.c **** 
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 19


 220:Src/User/motor_driver.c **** uint32_t last_hall_tick = 0;
 221:Src/User/motor_driver.c **** void motor_get_speed()
 222:Src/User/motor_driver.c **** {
 785              		.loc 1 222 0
 786              		.cfi_startproc
 787              		@ args = 0, pretend = 0, frame = 0
 788              		@ frame_needed = 0, uses_anonymous_args = 0
 789              		@ link register save eliminated.
 223:Src/User/motor_driver.c ****     static int32_t last_position = 0;
 224:Src/User/motor_driver.c **** 
 225:Src/User/motor_driver.c ****     motor.rpm = (motor.position - last_position);
 790              		.loc 1 225 0
 791 0000 0348     		ldr	r0, .L66
 792 0002 8168     		ldr	r1, [r0, #8]
 793 0004 034A     		ldr	r2, .L66+4
 794 0006 1368     		ldr	r3, [r2]
 795 0008 CB1A     		subs	r3, r1, r3
 796 000a 4380     		strh	r3, [r0, #2]	@ movhi
 226:Src/User/motor_driver.c **** 
 227:Src/User/motor_driver.c ****     last_position = motor.position;
 797              		.loc 1 227 0
 798 000c 1160     		str	r1, [r2]
 799 000e 7047     		bx	lr
 800              	.L67:
 801              		.align	2
 802              	.L66:
 803 0010 00000000 		.word	motor
 804 0014 00000000 		.word	.LANCHOR1
 805              		.cfi_endproc
 806              	.LFE137:
 808              		.section	.text.motor_check_0_speed,"ax",%progbits
 809              		.align	1
 810              		.global	motor_check_0_speed
 811              		.syntax unified
 812              		.thumb
 813              		.thumb_func
 814              		.fpu fpv4-sp-d16
 816              	motor_check_0_speed:
 817              	.LFB138:
 228:Src/User/motor_driver.c **** }
 229:Src/User/motor_driver.c **** 
 230:Src/User/motor_driver.c **** void motor_check_0_speed()
 231:Src/User/motor_driver.c **** {
 818              		.loc 1 231 0
 819              		.cfi_startproc
 820              		@ args = 0, pretend = 0, frame = 0
 821              		@ frame_needed = 0, uses_anonymous_args = 0
 822 0000 08B5     		push	{r3, lr}
 823              	.LCFI7:
 824              		.cfi_def_cfa_offset 8
 825              		.cfi_offset 3, -8
 826              		.cfi_offset 14, -4
 232:Src/User/motor_driver.c ****     // if (abs(motor.pwm_buffer) < 20 && hall_tick_10us - last_hall_tick > ZERO_SPEED_TIMEOUT)
 233:Src/User/motor_driver.c ****     //     motor.rpm = 0;
 234:Src/User/motor_driver.c **** 
 235:Src/User/motor_driver.c ****     if (motor.pwm_buffer == 0 && motor.rpm != 0)
 827              		.loc 1 235 0
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 20


 828 0002 0A4B     		ldr	r3, .L74
 829 0004 93F90130 		ldrsb	r3, [r3, #1]
 830 0008 1BB9     		cbnz	r3, .L69
 831              		.loc 1 235 0 is_stmt 0 discriminator 1
 832 000a 084A     		ldr	r2, .L74
 833 000c B2F90220 		ldrsh	r2, [r2, #2]
 834 0010 2AB9     		cbnz	r2, .L72
 835              	.L69:
 236:Src/User/motor_driver.c ****         phase_select(0);
 237:Src/User/motor_driver.c ****     else if (motor.rpm == 0 && motor.pwm_buffer != 0)
 836              		.loc 1 237 0 is_stmt 1
 837 0012 064A     		ldr	r2, .L74
 838 0014 B2F90220 		ldrsh	r2, [r2, #2]
 839 0018 02B9     		cbnz	r2, .L68
 840              		.loc 1 237 0 is_stmt 0 discriminator 1
 841 001a 23B9     		cbnz	r3, .L73
 842              	.L68:
 843 001c 08BD     		pop	{r3, pc}
 844              	.L72:
 236:Src/User/motor_driver.c ****         phase_select(0);
 845              		.loc 1 236 0 is_stmt 1
 846 001e 0020     		movs	r0, #0
 847 0020 FFF7FEFF 		bl	phase_select
 848              	.LVL108:
 849 0024 08BD     		pop	{r3, pc}
 850              	.L73:
 238:Src/User/motor_driver.c ****         motor_change_phase();
 851              		.loc 1 238 0
 852 0026 FFF7FEFF 		bl	motor_change_phase
 853              	.LVL109:
 239:Src/User/motor_driver.c **** }
 854              		.loc 1 239 0
 855 002a F7E7     		b	.L68
 856              	.L75:
 857              		.align	2
 858              	.L74:
 859 002c 00000000 		.word	motor
 860              		.cfi_endproc
 861              	.LFE138:
 863              		.section	.text.motor_get_position,"ax",%progbits
 864              		.align	1
 865              		.global	motor_get_position
 866              		.syntax unified
 867              		.thumb
 868              		.thumb_func
 869              		.fpu fpv4-sp-d16
 871              	motor_get_position:
 872              	.LFB139:
 240:Src/User/motor_driver.c **** 
 241:Src/User/motor_driver.c **** void motor_get_position()
 242:Src/User/motor_driver.c **** {
 873              		.loc 1 242 0
 874              		.cfi_startproc
 875              		@ args = 0, pretend = 0, frame = 0
 876              		@ frame_needed = 0, uses_anonymous_args = 0
 877 0000 08B5     		push	{r3, lr}
 878              	.LCFI8:
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 21


 879              		.cfi_def_cfa_offset 8
 880              		.cfi_offset 3, -8
 881              		.cfi_offset 14, -4
 243:Src/User/motor_driver.c ****     static uint8_t last_hall_state;
 244:Src/User/motor_driver.c ****     uint8_t current_hall_state = read_hall();
 882              		.loc 1 244 0
 883 0002 FFF7FEFF 		bl	read_hall
 884              	.LVL110:
 245:Src/User/motor_driver.c **** 
 246:Src/User/motor_driver.c ****     if ((hall_state_sequence[current_hall_state] == 1 && hall_state_sequence[last_hall_state] == 6)
 885              		.loc 1 246 0
 886 0006 234B     		ldr	r3, .L85
 887 0008 1B5C     		ldrb	r3, [r3, r0]	@ zero_extendqisi2
 888 000a 012B     		cmp	r3, #1
 889 000c 0ED0     		beq	.L82
 890              	.L77:
 247:Src/User/motor_driver.c ****         motor.position++;
 248:Src/User/motor_driver.c ****     else if (hall_state_sequence[current_hall_state] == 6 && hall_state_sequence[last_hall_state] =
 891              		.loc 1 248 0
 892 000e 062B     		cmp	r3, #6
 893 0010 17D0     		beq	.L83
 894              	.L79:
 249:Src/User/motor_driver.c ****         motor.position--;
 250:Src/User/motor_driver.c ****     else if (hall_state_sequence[last_hall_state] < hall_state_sequence[current_hall_state])
 895              		.loc 1 250 0
 896 0012 214A     		ldr	r2, .L85+4
 897 0014 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 898 0016 1F49     		ldr	r1, .L85
 899 0018 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 900 001a 9342     		cmp	r3, r2
 901 001c 1CD8     		bhi	.L84
 251:Src/User/motor_driver.c ****         motor.position++;
 252:Src/User/motor_driver.c ****     else if ((hall_state_sequence[last_hall_state] > hall_state_sequence[current_hall_state]))
 902              		.loc 1 252 0
 903 001e 9342     		cmp	r3, r2
 904 0020 1ED2     		bcs	.L78
 253:Src/User/motor_driver.c ****         motor.position--;
 905              		.loc 1 253 0
 906 0022 1E4A     		ldr	r2, .L85+8
 907 0024 9368     		ldr	r3, [r2, #8]
 908 0026 013B     		subs	r3, r3, #1
 909 0028 9360     		str	r3, [r2, #8]
 910 002a 19E0     		b	.L78
 911              	.L82:
 246:Src/User/motor_driver.c ****         motor.position++;
 912              		.loc 1 246 0 discriminator 1
 913 002c 1A4A     		ldr	r2, .L85+4
 914 002e 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 915 0030 1849     		ldr	r1, .L85
 916 0032 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 917 0034 062A     		cmp	r2, #6
 918 0036 EAD1     		bne	.L77
 247:Src/User/motor_driver.c ****     else if (hall_state_sequence[current_hall_state] == 6 && hall_state_sequence[last_hall_state] =
 919              		.loc 1 247 0
 920 0038 184A     		ldr	r2, .L85+8
 921 003a 9368     		ldr	r3, [r2, #8]
 922 003c 0133     		adds	r3, r3, #1
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 22


 923 003e 9360     		str	r3, [r2, #8]
 924 0040 0EE0     		b	.L78
 925              	.L83:
 248:Src/User/motor_driver.c ****         motor.position--;
 926              		.loc 1 248 0 discriminator 1
 927 0042 154A     		ldr	r2, .L85+4
 928 0044 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 929 0046 1349     		ldr	r1, .L85
 930 0048 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 931 004a 012A     		cmp	r2, #1
 932 004c E1D1     		bne	.L79
 249:Src/User/motor_driver.c ****     else if (hall_state_sequence[last_hall_state] < hall_state_sequence[current_hall_state])
 933              		.loc 1 249 0
 934 004e 134A     		ldr	r2, .L85+8
 935 0050 9368     		ldr	r3, [r2, #8]
 936 0052 013B     		subs	r3, r3, #1
 937 0054 9360     		str	r3, [r2, #8]
 938 0056 03E0     		b	.L78
 939              	.L84:
 251:Src/User/motor_driver.c ****     else if ((hall_state_sequence[last_hall_state] > hall_state_sequence[current_hall_state]))
 940              		.loc 1 251 0
 941 0058 104A     		ldr	r2, .L85+8
 942 005a 9368     		ldr	r3, [r2, #8]
 943 005c 0133     		adds	r3, r3, #1
 944 005e 9360     		str	r3, [r2, #8]
 945              	.L78:
 254:Src/User/motor_driver.c **** 
 255:Src/User/motor_driver.c ****     last_hall_state = current_hall_state;
 946              		.loc 1 255 0
 947 0060 0D4B     		ldr	r3, .L85+4
 948 0062 1870     		strb	r0, [r3]
 256:Src/User/motor_driver.c **** 
 257:Src/User/motor_driver.c ****     motor.degree = HALL2DEGREE(motor.position % POLAR_NUM);
 949              		.loc 1 257 0
 950 0064 0D48     		ldr	r0, .L85+8
 951              	.LVL111:
 952 0066 8168     		ldr	r1, [r0, #8]
 953 0068 0D4B     		ldr	r3, .L85+12
 954 006a 83FB0123 		smull	r2, r3, r3, r1
 955 006e 5A18     		adds	r2, r3, r1
 956 0070 CB17     		asrs	r3, r1, #31
 957 0072 C3EB6213 		rsb	r3, r3, r2, asr #5
 958 0076 C3EB0313 		rsb	r3, r3, r3, lsl #4
 959 007a 9A00     		lsls	r2, r3, #2
 960 007c 8B1A     		subs	r3, r1, r2
 961 007e 07EE903A 		vmov	s15, r3	@ int
 962 0082 F8EEE77A 		vcvt.f32.s32	s15, s15
 963 0086 B1EE087A 		vmov.f32	s14, #6.0e+0
 964 008a 67EE877A 		vmul.f32	s15, s15, s14
 965 008e C0ED037A 		vstr.32	s15, [r0, #12]
 966 0092 08BD     		pop	{r3, pc}
 967              	.L86:
 968              		.align	2
 969              	.L85:
 970 0094 00000000 		.word	.LANCHOR0
 971 0098 00000000 		.word	.LANCHOR2
 972 009c 00000000 		.word	motor
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 23


 973 00a0 89888888 		.word	-2004318071
 974              		.cfi_endproc
 975              	.LFE139:
 977              		.section	.text.motor_get_current,"ax",%progbits
 978              		.align	1
 979              		.global	motor_get_current
 980              		.syntax unified
 981              		.thumb
 982              		.thumb_func
 983              		.fpu fpv4-sp-d16
 985              	motor_get_current:
 986              	.LFB141:
 258:Src/User/motor_driver.c **** }
 259:Src/User/motor_driver.c **** 
 260:Src/User/motor_driver.c **** void adc_filter()
 261:Src/User/motor_driver.c **** {
 262:Src/User/motor_driver.c ****     static uint32_t adc_result_sum = 0;
 263:Src/User/motor_driver.c ****     static uint16_t adc_filter_cnt = 0;
 264:Src/User/motor_driver.c ****     adc_result_sum += adc_result_raw;
 265:Src/User/motor_driver.c ****     adc_filter_cnt++;
 266:Src/User/motor_driver.c ****     if (adc_filter_cnt > ADC_MEANFILTER_SIZE)
 267:Src/User/motor_driver.c ****     {
 268:Src/User/motor_driver.c ****         adc_result = (uint16_t)((float)adc_result_sum / ADC_MEANFILTER_SIZE + 0.5);
 269:Src/User/motor_driver.c ****         adc_result_sum = 0;
 270:Src/User/motor_driver.c ****         adc_filter_cnt = 0;
 271:Src/User/motor_driver.c ****         motor_get_current();
 272:Src/User/motor_driver.c ****     }
 273:Src/User/motor_driver.c **** }
 274:Src/User/motor_driver.c **** 
 275:Src/User/motor_driver.c **** void motor_get_current()
 276:Src/User/motor_driver.c **** {
 987              		.loc 1 276 0
 988              		.cfi_startproc
 989              		@ args = 0, pretend = 0, frame = 0
 990              		@ frame_needed = 0, uses_anonymous_args = 0
 991              		@ link register save eliminated.
 277:Src/User/motor_driver.c ****     motor.current = DRV8301_VOLTAGE2CURRENT(ADC2VOLTAGE(adc_result)) - current_dc_offset;
 992              		.loc 1 277 0
 993 0000 134B     		ldr	r3, .L88
 994 0002 1B88     		ldrh	r3, [r3]
 995 0004 07EE103A 		vmov	s14, r3	@ int
 996 0008 B8EEC77A 		vcvt.f32.s32	s14, s14
 997 000c DFED116A 		vldr.32	s13, .L88+4
 998 0010 C7EE267A 		vdiv.f32	s15, s14, s13
 999 0014 9FED107A 		vldr.32	s14, .L88+8
 1000 0018 27EE877A 		vmul.f32	s14, s15, s14
 1001 001c DFED0F7A 		vldr.32	s15, .L88+12
 1002 0020 77EEC77A 		vsub.f32	s15, s15, s14
 1003 0024 9FED0E7A 		vldr.32	s14, .L88+16
 1004 0028 C7EE876A 		vdiv.f32	s13, s15, s14
 1005 002c 9FED0D7A 		vldr.32	s14, .L88+20
 1006 0030 C6EE877A 		vdiv.f32	s15, s13, s14
 1007 0034 9FED0C7A 		vldr.32	s14, .L88+24
 1008 0038 77EEC77A 		vsub.f32	s15, s15, s14
 1009 003c 0B4B     		ldr	r3, .L88+28
 1010 003e 93ED007A 		vldr.32	s14, [r3]
 1011 0042 77EEC77A 		vsub.f32	s15, s15, s14
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 24


 1012 0046 0A4B     		ldr	r3, .L88+32
 1013 0048 C3ED017A 		vstr.32	s15, [r3, #4]
 1014 004c 7047     		bx	lr
 1015              	.L89:
 1016 004e 00BF     		.align	2
 1017              	.L88:
 1018 0050 00000000 		.word	adc_result
 1019 0054 00F07F45 		.word	1166012416
 1020 0058 33335340 		.word	1079194419
 1021 005c 3333D33F 		.word	1070805811
 1022 0060 0000A042 		.word	1117782016
 1023 0064 6F12033B 		.word	990057071
 1024 0068 0AD7233C 		.word	1008981770
 1025 006c 00000000 		.word	current_dc_offset
 1026 0070 00000000 		.word	motor
 1027              		.cfi_endproc
 1028              	.LFE141:
 1030              		.global	__aeabi_f2d
 1031              		.global	__aeabi_dadd
 1032              		.global	__aeabi_d2uiz
 1033              		.section	.text.adc_filter,"ax",%progbits
 1034              		.align	1
 1035              		.global	adc_filter
 1036              		.syntax unified
 1037              		.thumb
 1038              		.thumb_func
 1039              		.fpu fpv4-sp-d16
 1041              	adc_filter:
 1042              	.LFB140:
 261:Src/User/motor_driver.c ****     static uint32_t adc_result_sum = 0;
 1043              		.loc 1 261 0
 1044              		.cfi_startproc
 1045              		@ args = 0, pretend = 0, frame = 0
 1046              		@ frame_needed = 0, uses_anonymous_args = 0
 1047 0000 08B5     		push	{r3, lr}
 1048              	.LCFI9:
 1049              		.cfi_def_cfa_offset 8
 1050              		.cfi_offset 3, -8
 1051              		.cfi_offset 14, -4
 264:Src/User/motor_driver.c ****     adc_filter_cnt++;
 1052              		.loc 1 264 0
 1053 0002 154B     		ldr	r3, .L94
 1054 0004 1A88     		ldrh	r2, [r3]
 1055 0006 154B     		ldr	r3, .L94+4
 1056 0008 1968     		ldr	r1, [r3]
 1057 000a 0A44     		add	r2, r2, r1
 1058 000c 1A60     		str	r2, [r3]
 265:Src/User/motor_driver.c ****     if (adc_filter_cnt > ADC_MEANFILTER_SIZE)
 1059              		.loc 1 265 0
 1060 000e 1449     		ldr	r1, .L94+8
 1061 0010 0B88     		ldrh	r3, [r1]
 1062 0012 0133     		adds	r3, r3, #1
 1063 0014 9BB2     		uxth	r3, r3
 1064 0016 0B80     		strh	r3, [r1]	@ movhi
 266:Src/User/motor_driver.c ****     {
 1065              		.loc 1 266 0
 1066 0018 642B     		cmp	r3, #100
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 25


 1067 001a 00D8     		bhi	.L93
 1068              	.L90:
 1069 001c 08BD     		pop	{r3, pc}
 1070              	.L93:
 268:Src/User/motor_driver.c ****         adc_result_sum = 0;
 1071              		.loc 1 268 0
 1072 001e 07EE902A 		vmov	s15, r2	@ int
 1073 0022 F8EE677A 		vcvt.f32.u32	s15, s15
 1074 0026 9FED0F7A 		vldr.32	s14, .L94+12
 1075 002a C7EE876A 		vdiv.f32	s13, s15, s14
 1076 002e 16EE900A 		vmov	r0, s13
 1077 0032 FFF7FEFF 		bl	__aeabi_f2d
 1078              	.LVL112:
 1079 0036 0022     		movs	r2, #0
 1080 0038 0B4B     		ldr	r3, .L94+16
 1081 003a FFF7FEFF 		bl	__aeabi_dadd
 1082              	.LVL113:
 1083 003e FFF7FEFF 		bl	__aeabi_d2uiz
 1084              	.LVL114:
 1085 0042 0A4B     		ldr	r3, .L94+20
 1086 0044 1880     		strh	r0, [r3]	@ movhi
 269:Src/User/motor_driver.c ****         adc_filter_cnt = 0;
 1087              		.loc 1 269 0
 1088 0046 0023     		movs	r3, #0
 1089 0048 044A     		ldr	r2, .L94+4
 1090 004a 1360     		str	r3, [r2]
 270:Src/User/motor_driver.c ****         motor_get_current();
 1091              		.loc 1 270 0
 1092 004c 044A     		ldr	r2, .L94+8
 1093 004e 1380     		strh	r3, [r2]	@ movhi
 271:Src/User/motor_driver.c ****     }
 1094              		.loc 1 271 0
 1095 0050 FFF7FEFF 		bl	motor_get_current
 1096              	.LVL115:
 273:Src/User/motor_driver.c **** 
 1097              		.loc 1 273 0
 1098 0054 E2E7     		b	.L90
 1099              	.L95:
 1100 0056 00BF     		.align	2
 1101              	.L94:
 1102 0058 00000000 		.word	adc_result_raw
 1103 005c 00000000 		.word	.LANCHOR3
 1104 0060 00000000 		.word	.LANCHOR4
 1105 0064 0000C842 		.word	1120403456
 1106 0068 0000E03F 		.word	1071644672
 1107 006c 00000000 		.word	adc_result
 1108              		.cfi_endproc
 1109              	.LFE140:
 1111              		.section	.text.motor_current_loop,"ax",%progbits
 1112              		.align	1
 1113              		.global	motor_current_loop
 1114              		.syntax unified
 1115              		.thumb
 1116              		.thumb_func
 1117              		.fpu fpv4-sp-d16
 1119              	motor_current_loop:
 1120              	.LFB142:
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 26


 278:Src/User/motor_driver.c ****     // motor.current = ADC2VOLTAGE(adc_result);
 279:Src/User/motor_driver.c **** }
 280:Src/User/motor_driver.c **** 
 281:Src/User/motor_driver.c **** void motor_current_loop(float set)
 282:Src/User/motor_driver.c **** {
 1121              		.loc 1 282 0
 1122              		.cfi_startproc
 1123              		@ args = 0, pretend = 0, frame = 0
 1124              		@ frame_needed = 0, uses_anonymous_args = 0
 1125              	.LVL116:
 1126 0000 10B5     		push	{r4, lr}
 1127              	.LCFI10:
 1128              		.cfi_def_cfa_offset 8
 1129              		.cfi_offset 4, -8
 1130              		.cfi_offset 14, -4
 283:Src/User/motor_driver.c ****     motor.pwm = pid_calculate(&motor_pid_current, motor.current, set);
 1131              		.loc 1 283 0
 1132 0002 074C     		ldr	r4, .L98
 1133 0004 F0EE400A 		vmov.f32	s1, s0
 1134 0008 94ED010A 		vldr.32	s0, [r4, #4]
 1135              	.LVL117:
 1136 000c 0548     		ldr	r0, .L98+4
 1137 000e FFF7FEFF 		bl	pid_calculate
 1138              	.LVL118:
 1139 0012 FDEEC07A 		vcvt.s32.f32	s15, s0
 1140 0016 17EE903A 		vmov	r3, s15	@ int
 1141 001a 2370     		strb	r3, [r4]
 1142 001c 10BD     		pop	{r4, pc}
 1143              	.L99:
 1144 001e 00BF     		.align	2
 1145              	.L98:
 1146 0020 00000000 		.word	motor
 1147 0024 00000000 		.word	motor_pid_current
 1148              		.cfi_endproc
 1149              	.LFE142:
 1151              		.section	.text.motor_speed_loop,"ax",%progbits
 1152              		.align	1
 1153              		.global	motor_speed_loop
 1154              		.syntax unified
 1155              		.thumb
 1156              		.thumb_func
 1157              		.fpu fpv4-sp-d16
 1159              	motor_speed_loop:
 1160              	.LFB143:
 284:Src/User/motor_driver.c **** }
 285:Src/User/motor_driver.c **** 
 286:Src/User/motor_driver.c **** void motor_speed_loop(float set)
 287:Src/User/motor_driver.c **** {
 1161              		.loc 1 287 0
 1162              		.cfi_startproc
 1163              		@ args = 0, pretend = 0, frame = 0
 1164              		@ frame_needed = 0, uses_anonymous_args = 0
 1165              	.LVL119:
 1166 0000 10B5     		push	{r4, lr}
 1167              	.LCFI11:
 1168              		.cfi_def_cfa_offset 8
 1169              		.cfi_offset 4, -8
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 27


 1170              		.cfi_offset 14, -4
 288:Src/User/motor_driver.c ****     motor.pwm = pid_calculate(&motor_pid_speed, motor.rpm, set);
 1171              		.loc 1 288 0
 1172 0002 094C     		ldr	r4, .L102
 1173 0004 B4F90230 		ldrsh	r3, [r4, #2]
 1174 0008 F0EE400A 		vmov.f32	s1, s0
 1175 000c 07EE903A 		vmov	s15, r3	@ int
 1176 0010 B8EEE70A 		vcvt.f32.s32	s0, s15
 1177              	.LVL120:
 1178 0014 0548     		ldr	r0, .L102+4
 1179 0016 FFF7FEFF 		bl	pid_calculate
 1180              	.LVL121:
 1181 001a FDEEC07A 		vcvt.s32.f32	s15, s0
 1182 001e 17EE903A 		vmov	r3, s15	@ int
 1183 0022 2370     		strb	r3, [r4]
 1184 0024 10BD     		pop	{r4, pc}
 1185              	.L103:
 1186 0026 00BF     		.align	2
 1187              	.L102:
 1188 0028 00000000 		.word	motor
 1189 002c 00000000 		.word	motor_pid_speed
 1190              		.cfi_endproc
 1191              	.LFE143:
 1193              		.section	.text.motor_position_loop,"ax",%progbits
 1194              		.align	1
 1195              		.global	motor_position_loop
 1196              		.syntax unified
 1197              		.thumb
 1198              		.thumb_func
 1199              		.fpu fpv4-sp-d16
 1201              	motor_position_loop:
 1202              	.LFB144:
 289:Src/User/motor_driver.c ****     // if (set >= 0)
 290:Src/User/motor_driver.c ****     //     motor.pwm_buffer = pid_calculate(&motor_pid_speed, motor.rpm, set);
 291:Src/User/motor_driver.c ****     // else
 292:Src/User/motor_driver.c ****     //     motor.pwm_buffer = -pid_calculate(&motor_pid_speed, motor.rpm, set);
 293:Src/User/motor_driver.c **** }
 294:Src/User/motor_driver.c **** 
 295:Src/User/motor_driver.c **** void motor_position_loop(float set)
 296:Src/User/motor_driver.c **** {
 1203              		.loc 1 296 0
 1204              		.cfi_startproc
 1205              		@ args = 0, pretend = 0, frame = 0
 1206              		@ frame_needed = 0, uses_anonymous_args = 0
 1207              	.LVL122:
 1208 0000 10B5     		push	{r4, lr}
 1209              	.LCFI12:
 1210              		.cfi_def_cfa_offset 8
 1211              		.cfi_offset 4, -8
 1212              		.cfi_offset 14, -4
 297:Src/User/motor_driver.c ****     motor.pwm = pid_calculate(&motor_pid_position, motor.position, set);
 1213              		.loc 1 297 0
 1214 0002 084C     		ldr	r4, .L106
 1215 0004 F0EE400A 		vmov.f32	s1, s0
 1216 0008 D4ED027A 		vldr.32	s15, [r4, #8]	@ int
 1217 000c B8EEE70A 		vcvt.f32.s32	s0, s15
 1218              	.LVL123:
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 28


 1219 0010 0548     		ldr	r0, .L106+4
 1220 0012 FFF7FEFF 		bl	pid_calculate
 1221              	.LVL124:
 1222 0016 FDEEC07A 		vcvt.s32.f32	s15, s0
 1223 001a 17EE903A 		vmov	r3, s15	@ int
 1224 001e 2370     		strb	r3, [r4]
 1225 0020 10BD     		pop	{r4, pc}
 1226              	.L107:
 1227 0022 00BF     		.align	2
 1228              	.L106:
 1229 0024 00000000 		.word	motor
 1230 0028 00000000 		.word	motor_pid_position
 1231              		.cfi_endproc
 1232              	.LFE144:
 1234              		.section	.text.motor_pwm_buffer,"ax",%progbits
 1235              		.align	1
 1236              		.global	motor_pwm_buffer
 1237              		.syntax unified
 1238              		.thumb
 1239              		.thumb_func
 1240              		.fpu fpv4-sp-d16
 1242              	motor_pwm_buffer:
 1243              	.LFB145:
 298:Src/User/motor_driver.c **** }
 299:Src/User/motor_driver.c **** 
 300:Src/User/motor_driver.c **** void motor_pwm_buffer()
 301:Src/User/motor_driver.c **** {
 1244              		.loc 1 301 0
 1245              		.cfi_startproc
 1246              		@ args = 0, pretend = 0, frame = 0
 1247              		@ frame_needed = 0, uses_anonymous_args = 0
 1248              		@ link register save eliminated.
 302:Src/User/motor_driver.c ****     // int8_t pwm_diff = motor.pwm - motor.pwm_buffer;
 303:Src/User/motor_driver.c ****     // if (motor.pwm > 0 && motor.pwm_buffer <= 0)
 304:Src/User/motor_driver.c ****     // {
 305:Src/User/motor_driver.c ****     //     if (motor.rpm != 0)
 306:Src/User/motor_driver.c ****     //         motor.pwm_buffer = 0;
 307:Src/User/motor_driver.c ****     //     else
 308:Src/User/motor_driver.c ****     //         motor.pwm_buffer++;
 309:Src/User/motor_driver.c ****     // }
 310:Src/User/motor_driver.c ****     // else if (motor.pwm < 0 && motor.pwm_buffer >= 0)
 311:Src/User/motor_driver.c ****     // {
 312:Src/User/motor_driver.c ****     //     if (motor.rpm != 0)
 313:Src/User/motor_driver.c ****     //         motor.pwm_buffer = 0;
 314:Src/User/motor_driver.c ****     //     else
 315:Src/User/motor_driver.c ****     //         motor.pwm_buffer--;
 316:Src/User/motor_driver.c ****     // }
 317:Src/User/motor_driver.c **** 
 318:Src/User/motor_driver.c ****     int8_t pwm_diff = motor.pwm - motor.pwm_buffer;
 1249              		.loc 1 318 0
 1250 0000 084A     		ldr	r2, .L112
 1251 0002 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1252 0004 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1253 0006 9B1A     		subs	r3, r3, r2
 1254 0008 5BB2     		sxtb	r3, r3
 1255              	.LVL125:
 319:Src/User/motor_driver.c ****     if (pwm_diff > 0)
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 29


 1256              		.loc 1 319 0
 1257 000a 002B     		cmp	r3, #0
 1258 000c 03DD     		ble	.L109
 320:Src/User/motor_driver.c ****         motor.pwm_buffer++;
 1259              		.loc 1 320 0
 1260 000e 0132     		adds	r2, r2, #1
 1261 0010 044B     		ldr	r3, .L112
 1262              	.LVL126:
 1263 0012 5A70     		strb	r2, [r3, #1]
 1264 0014 7047     		bx	lr
 1265              	.LVL127:
 1266              	.L109:
 321:Src/User/motor_driver.c ****     else if (pwm_diff < 0)
 1267              		.loc 1 321 0
 1268 0016 002B     		cmp	r3, #0
 1269 0018 00DB     		blt	.L111
 1270              	.LVL128:
 1271              	.L108:
 1272 001a 7047     		bx	lr
 1273              	.LVL129:
 1274              	.L111:
 322:Src/User/motor_driver.c ****         motor.pwm_buffer--;
 1275              		.loc 1 322 0
 1276 001c 013A     		subs	r2, r2, #1
 1277 001e 014B     		ldr	r3, .L112
 1278              	.LVL130:
 1279 0020 5A70     		strb	r2, [r3, #1]
 323:Src/User/motor_driver.c **** 
 324:Src/User/motor_driver.c ****     // motor.pwm_buffer = motor.pwm;
 325:Src/User/motor_driver.c **** }...
 1280              		.loc 1 325 0
 1281 0022 FAE7     		b	.L108
 1282              	.L113:
 1283              		.align	2
 1284              	.L112:
 1285 0024 00000000 		.word	motor
 1286              		.cfi_endproc
 1287              	.LFE145:
 1289              		.global	last_hall_tick
 1290              		.comm	hall,1,1
 1291              		.global	hall_state_sequence
 1292              		.comm	motor_pid_position,56,4
 1293              		.comm	motor_pid_speed,56,4
 1294              		.comm	motor_pid_current,56,4
 1295              		.comm	current_dc_offset,4,4
 1296              		.comm	adc_result,2,2
 1297              		.comm	adc_result_raw,2,2
 1298              		.comm	drv8301_spi_tx_dat,2,2
 1299              		.comm	drv8301_spi_rx_dat,2,2
 1300              		.comm	motor,16,4
 1301              		.section	.bss.adc_filter_cnt.9093,"aw",%nobits
 1302              		.align	1
 1303              		.set	.LANCHOR4,. + 0
 1306              	adc_filter_cnt.9093:
 1307 0000 0000     		.space	2
 1308              		.section	.bss.adc_result_sum.9092,"aw",%nobits
 1309              		.align	2
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 30


 1310              		.set	.LANCHOR3,. + 0
 1313              	adc_result_sum.9092:
 1314 0000 00000000 		.space	4
 1315              		.section	.bss.last_hall_state.9088,"aw",%nobits
 1316              		.set	.LANCHOR2,. + 0
 1319              	last_hall_state.9088:
 1320 0000 00       		.space	1
 1321              		.section	.bss.last_hall_tick,"aw",%nobits
 1322              		.align	2
 1325              	last_hall_tick:
 1326 0000 00000000 		.space	4
 1327              		.section	.bss.last_position.9083,"aw",%nobits
 1328              		.align	2
 1329              		.set	.LANCHOR1,. + 0
 1332              	last_position.9083:
 1333 0000 00000000 		.space	4
 1334              		.section	.rodata.hall_state_sequence,"a",%progbits
 1335              		.align	2
 1336              		.set	.LANCHOR0,. + 0
 1339              	hall_state_sequence:
 1340 0000 00       		.byte	0
 1341 0001 06       		.byte	6
 1342 0002 04       		.byte	4
 1343 0003 05       		.byte	5
 1344 0004 02       		.byte	2
 1345 0005 01       		.byte	1
 1346 0006 03       		.byte	3
 1347 0007 00       		.byte	0
 1348              		.text
 1349              	.Letext0:
 1350              		.file 2 "/Users/geekzjk/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/machine/_defa
 1351              		.file 3 "/Users/geekzjk/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/_stdint.h
 1352              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 1353              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 1354              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 1355              		.file 7 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 1356              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 1357              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 1358              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 1359              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_adc.h"
 1360              		.file 12 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_can.h"
 1361              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 1362              		.file 14 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 1363              		.file 15 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 1364              		.file 16 "Inc/tim.h"
 1365              		.file 17 "Inc/spi.h"
 1366              		.file 18 "Inc/adc.h"
 1367              		.file 19 "Inc/User/algorithm.h"
 1368              		.file 20 "Inc/can.h"
 1369              		.file 21 "Inc/User/can_protocol.h"
 1370              		.file 22 "/Users/geekzjk/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/lock.h"
 1371              		.file 23 "/Users/geekzjk/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/_types.h
 1372              		.file 24 "/Users/geekzjk/opt/gcc-arm-none-eabi-6-2017-q2-update/lib/gcc/arm-none-eabi/6.3.1/includ
 1373              		.file 25 "/Users/geekzjk/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/reent.h"
 1374              		.file 26 "Inc/User/WS2812B.h"
 1375              		.file 27 "Inc/User/MPU6050.h"
 1376              		.file 28 "Inc/User/M3508.h"
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 31


 1377              		.file 29 "Inc/User/user_control.h"
 1378              		.file 30 "Inc/User/user_main.h"
 1379              		.file 31 "/Users/geekzjk/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/stdlib.h"
 1380              		.file 32 "Inc/User/motor_driver.h"
 1381              		.file 33 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim_ex.h"
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 32


DEFINED SYMBOLS
                            *ABS*:0000000000000000 motor_driver.c
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:18     .text.read_hall:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:25     .text.read_hall:0000000000000000 read_hall
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:87     .text.read_hall:0000000000000040 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:93     .text.mosfet_control:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:100    .text.mosfet_control:0000000000000000 mosfet_control
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:355    .text.mosfet_control:000000000000018c $d
                            *COM*:0000000000000010 motor
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:363    .text.phase_select:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:370    .text.phase_select:0000000000000000 phase_select
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:387    .text.phase_select:000000000000000a $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:538    .text.drv8301_spi_sent:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:545    .text.drv8301_spi_sent:0000000000000000 drv8301_spi_sent
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:622    .text.drv8301_spi_sent:0000000000000070 $d
                            *COM*:0000000000000002 drv8301_spi_tx_dat
                            *COM*:0000000000000002 drv8301_spi_rx_dat
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:630    .text.motor_start:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:637    .text.motor_start:0000000000000000 motor_start
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:668    .text.motor_start:0000000000000030 $d
                            *COM*:0000000000000038 motor_pid_speed
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:676    .text.motor_stop:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:683    .text.motor_stop:0000000000000000 motor_stop
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:708    .text.motor_stop:0000000000000018 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:713    .text.motor_change_phase:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:720    .text.motor_change_phase:0000000000000000 motor_change_phase
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:769    .text.motor_change_phase:000000000000003c $d
                            *COM*:0000000000000001 hall
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:776    .text.motor_get_speed:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:783    .text.motor_get_speed:0000000000000000 motor_get_speed
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:803    .text.motor_get_speed:0000000000000010 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:809    .text.motor_check_0_speed:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:816    .text.motor_check_0_speed:0000000000000000 motor_check_0_speed
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:859    .text.motor_check_0_speed:000000000000002c $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:864    .text.motor_get_position:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:871    .text.motor_get_position:0000000000000000 motor_get_position
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:970    .text.motor_get_position:0000000000000094 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:978    .text.motor_get_current:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:985    .text.motor_get_current:0000000000000000 motor_get_current
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1018   .text.motor_get_current:0000000000000050 $d
                            *COM*:0000000000000002 adc_result
                            *COM*:0000000000000004 current_dc_offset
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1034   .text.adc_filter:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1041   .text.adc_filter:0000000000000000 adc_filter
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1102   .text.adc_filter:0000000000000058 $d
                            *COM*:0000000000000002 adc_result_raw
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1112   .text.motor_current_loop:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1119   .text.motor_current_loop:0000000000000000 motor_current_loop
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1146   .text.motor_current_loop:0000000000000020 $d
                            *COM*:0000000000000038 motor_pid_current
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1152   .text.motor_speed_loop:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1159   .text.motor_speed_loop:0000000000000000 motor_speed_loop
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1188   .text.motor_speed_loop:0000000000000028 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1194   .text.motor_position_loop:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1201   .text.motor_position_loop:0000000000000000 motor_position_loop
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1229   .text.motor_position_loop:0000000000000024 $d
                            *COM*:0000000000000038 motor_pid_position
ARM GAS  /var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s 			page 33


/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1235   .text.motor_pwm_buffer:0000000000000000 $t
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1242   .text.motor_pwm_buffer:0000000000000000 motor_pwm_buffer
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1285   .text.motor_pwm_buffer:0000000000000024 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1325   .bss.last_hall_tick:0000000000000000 last_hall_tick
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1339   .rodata.hall_state_sequence:0000000000000000 hall_state_sequence
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1302   .bss.adc_filter_cnt.9093:0000000000000000 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1306   .bss.adc_filter_cnt.9093:0000000000000000 adc_filter_cnt.9093
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1309   .bss.adc_result_sum.9092:0000000000000000 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1313   .bss.adc_result_sum.9092:0000000000000000 adc_result_sum.9092
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1319   .bss.last_hall_state.9088:0000000000000000 last_hall_state.9088
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1320   .bss.last_hall_state.9088:0000000000000000 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1322   .bss.last_hall_tick:0000000000000000 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1328   .bss.last_position.9083:0000000000000000 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1332   .bss.last_position.9083:0000000000000000 last_position.9083
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:1335   .rodata.hall_state_sequence:0000000000000000 $d
                     .debug_frame:0000000000000010 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:394    .text.phase_select:0000000000000011 $d
/var/folders/kp/233_yh1j2dd9gvn3v4mq48f40000gn/T//ccGxXeW4.s:394    .text.phase_select:0000000000000012 $t

UNDEFINED SYMBOLS
HAL_GPIO_ReadPin
HAL_TIM_PWM_Stop
HAL_TIMEx_PWMN_Stop
HAL_TIM_PWM_Start
HAL_TIMEx_PWMN_Start
htim1
HAL_GPIO_WritePin
HAL_Delay
HAL_SPI_Transmit
HAL_SPI_Receive
hspi3
pid_init
__aeabi_f2d
__aeabi_dadd
__aeabi_d2uiz
pid_calculate
